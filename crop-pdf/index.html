<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Crop PDF ‚Äì Skill2Job Tools</title>
  <meta name="description" content="Crop PDF pages online free. Fast, accurate, mobile-friendly.">
  
  <!-- FAVICON -->
  <link rel="icon" type="image/webp" href="https://i.postimg.cc/YCnzSpLg/Official_Logo.webp">
  
  <!-- FONTS -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  
  <!-- ‚úÖ PDF LIBRARIES - CRITICAL ORDER -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
</head>
<body>
  <!-- HEADER -->
  <header class="site-header">
    <div class="container header-inner">
      <div class="logo">
        <a href="/"><img src="https://i.postimg.cc/YCnzSpLg/Official_Logo.webp" alt="Skill2Job"></a>
      </div>
      <button class="share-btn">Share</button>
    </div>
  </header>

  <main class="site-main">
    <!-- ‚úÖ CROP TOOL SECTION -->
    <section class="section">
      <div class="container">
        <div class="card age-tool-card">
          <h1 class="tool-title">Crop PDF Pages</h1>
          
          <!-- UPLOAD -->
          <div class="input-group">
            <label for="pdfFile">Upload PDF</label>
            <input type="file" id="pdfFile" accept=".pdf">
          </div>
          
          <button class="calculate-btn" id="uploadBtn">Upload PDF</button>
          
          <!-- SPINNER -->
          <div class="loading" id="uploadLoading">
            <div class="spinner"></div>
            <p>Processing PDF...</p>
          </div>
          
          <!-- SUCCESS -->
          <div class="result" id="successMsg" style="display:none;">
            <strong>‚úÖ PDF Loaded!</strong>
            <p>Select page to crop ‚Üì</p>
          </div>
          
          <!-- PAGE SELECT -->
          <div class="input-group" id="pageSelectGroup" style="display:none;">
            <label for="pageSelect">Choose Page</label>
            <select id="pageSelect"></select>
          </div>
          
          <!-- CROP BUTTON -->
          <button class="calculate-btn" id="cropBtn" style="display:none;">Create Cropped PDF</button>
          
          <!-- CROP SPINNER -->
          <div class="loading" id="cropLoading" style="display:none;">
            <div class="spinner"></div>
            <p>Creating PDF...</p>
          </div>
          
          <!-- THUMBNAILS -->
          <div class="pdf-grid" id="pdfPages" style="display:none;"></div>
          
          <!-- DOWNLOAD -->
          <div id="downloadWrapper" style="display:none; margin-top:20px;">
            <a class="calculate-btn" id="downloadBtn" download>üì• Download PDF</a>
          </div>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section class="section">
      <div class="container">
        <div class="card">
          <h2>About Crop PDF</h2>
          <p>Skill2Job's free Crop PDF tool lets you easily extract specific pages from any PDF. Perfect for students, professionals, and anyone needing clean single-page PDFs. All processing happens locally - your files stay private.</p>
        </div>
      </div>
    </section>

    <!-- MORE TOOLS -->
    <section class="section">
      <div class="container">
        <div class="card">
          <h2>More Tools</h2>
          <div class="tools-grid">
            <div class="tool-card"><h3>Merge PDF</h3><p>Combine PDFs</p><a class="tool-link" href="/merge-pdf/">Use Tool</a></div>
            <div class="tool-card"><h3>Remove Pages</h3><p>Delete PDF pages</p><a class="tool-link" href="/remove-pages/">Use Tool</a></div>
            <div class="tool-card"><h3>Age Calculator</h3><p>Calculate exact age</p><a class="tool-link" href="/age-calculator">Use Tool</a></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <p><strong>Skill2Job Tools</strong> | <a href="/">Home</a> | <a href="/about">About</a> | <a href="/privacy">Privacy</a></p>
    <p>¬© 2026 Skill2Job</p>
  </footer>

  <!-- ‚úÖ COMPLETE WORKING JS -->
  <script>
  (function() {
    'use strict';
    
    let pdfDoc = null;
    let currentPage = 1;
    
    // Setup PDF.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    
    // Elements
    const els = {
      uploadBtn: document.getElementById('uploadBtn'),
      cropBtn: document.getElementById('cropBtn'),
      downloadBtn: document.getElementById('downloadBtn'),
      pdfFile: document.getElementById('pdfFile'),
      successMsg: document.getElementById('successMsg'),
      pageSelectGroup: document.getElementById('pageSelectGroup'),
      pageSelect: document.getElementById('pageSelect'),
      pdfPages: document.getElementById('pdfPages'),
      uploadLoading: document.getElementById('uploadLoading'),
      cropLoading: document.getElementById('cropLoading'),
      downloadWrapper: document.getElementById('downloadWrapper')
    };
    
    // Init
    function init() {
      els.uploadBtn.addEventListener('click', uploadPDF);
      els.cropBtn.addEventListener('click', createCroppedPDF);
      els.pageSelect.addEventListener('change', onPageChange);
      document.querySelector('.share-btn').addEventListener('click', shareTool);
    }
    
    // Upload PDF
    async function uploadPDF() {
      const file = els.pdfFile.files[0];
      
      if (!file) {
        showError('Please select a PDF file');
        return;
      }
      
      // Show spinner
      els.uploadLoading.style.display = 'block';
      hideAll();
      
      try {
        pdfDoc = await pdfjsLib.getDocument(URL.createObjectURL(file)).promise;
        
        // Hide spinner, show success
        els.uploadLoading.style.display = 'none';
        els.successMsg.style.display = 'block';
        
        // Setup pages
        await setupPages();
        
      } catch (e) {
        els.uploadLoading.style.display = 'none';
        showError('Failed to load PDF');
      }
    }
    
    // Setup page selector & thumbnails
    async function setupPages() {
      els.pageSelectGroup.style.display = 'block';
      els.cropBtn.style.display = 'block';
      els.pdfPages.style.display = 'grid';
      
      // Page selector
      els.pageSelect.innerHTML = '';
      for (let i = 1; i <= pdfDoc.numPages; i++) {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = `Page ${i}`;
        els.pageSelect.appendChild(opt);
      }
      
      // Thumbnails
      await renderThumbnails();
    }
    
    // Render thumbnails
    async function renderThumbnails() {
      els.pdfPages.innerHTML = '';
      for (let i = 1; i <= pdfDoc.numPages; i++) {
        const page = await pdfDoc.getPage(i);
        const canvas = document.createElement('canvas');
        const scale = 0.2;
        const viewport = page.getViewport({scale});
        
        canvas.height = viewport.height;
        canvas.width = viewport.width;
        
        await page.render({canvasContext: canvas.getContext('2d'), viewport}).promise;
        
        const pageDiv = document.createElement('div');
        pageDiv.className = 'pdf-page';
        pageDiv.dataset.page = i;
        pageDiv.innerHTML = '<span class="remove-mark">√ó</span>';
        pageDiv.appendChild(canvas);
        pageDiv.addEventListener('click', () => selectPage(i));
        
        els.pdfPages.appendChild(pageDiv);
      }
    }
    
    // Select page
    function selectPage(pageNum) {
      currentPage = pageNum;
      document.querySelectorAll('.pdf-page').forEach(p => p.classList.remove('selected'));
      document.querySelector(`[data-page="${pageNum}"]`).classList.add('selected');
      els.pageSelect.value = pageNum;
    }
    
    // Page change
    function onPageChange() {
      currentPage = parseInt(els.pageSelect.value);
      renderThumbnails();
    }
    
    // Create cropped PDF (single page)
    async function createCroppedPDF() {
      els.cropLoading.style.display = 'block';
      hideAll();
      
      try {
        const pdfBytes = await pdfDoc.getData();
        const pdfDocLib = await PDFLib.PDFDocument.load(pdfBytes);
        
        // Copy selected page only
        const [page] = await pdfDocLib.copyPages(pdfDocLib, [currentPage - 1]);
        const newPdf = await PDFLib.PDFDocument.create();
        newPdf.addPage(page);
        
        const newPdfBytes = await newPdf.save();
        
        // Download
        const blob = new Blob([newPdfBytes], {type: 'application/pdf'});
        els.downloadBtn.href = URL.createObjectURL(blob);
        els.downloadBtn.download = `skill2job-cropped-page-${currentPage}.pdf`;
        els.downloadWrapper.style.display = 'block';
        
      } catch (e) {
        showError('Failed to create PDF');
      }
      
      els.cropLoading.style.display = 'none';
    }
    
    // Utils
    function hideAll() {
      [els.successMsg, els.pageSelectGroup, els.pdfPages, els.downloadWrapper].forEach(el => {
        el.style.display = 'none';
      });
    }
    
    function showError(msg) {
      els.successMsg.innerHTML = `<strong>‚ùå ${msg}</strong>`;
      els.successMsg.style.display = 'block';
    }
    
    // Share
    async function shareTool() {
      try {
        if (navigator.share) {
          await navigator.share({title: 'Crop PDF - Skill2Job', url: location.href});
        } else {
          await navigator.clipboard.writeText(location.href);
          document.querySelector('.share-btn').textContent = 'Copied!';
          setTimeout(() => document.querySelector('.share-btn').textContent = 'Share', 2000);
        }
      } catch {
        prompt('Copy this link:', location.href);
      }
    }
    
    // Start
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  })();
  </script>
</body>
</html>
